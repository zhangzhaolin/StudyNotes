ç¬¬äº”ç«  æ„å»ºSpring Webåº”ç”¨ç¨‹åº

[TOC]

## ä»£ç 

æœ¬ç« ç›¸å…³ä»£ç å­˜æ”¾åœ¨GITä¸­ ï¼š[ç¬¬äº”ç«  æ„å»ºSpring Webåº”ç”¨ç¨‹åº](https://github.com/zhangzhaolin/spring-demo/tree/master/%E7%AC%AC%E4%BA%94%E7%AB%A0%20%E6%9E%84%E5%BB%BASpring%20MVC%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/%E6%90%AD%E5%BB%BA%E6%9C%80%E5%9F%BA%E7%A1%80%E7%9A%84Spring%20MVC%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F)

## æ§åˆ¶å™¨ã€æ¨¡å‹å’Œè§†å›¾

- æ§åˆ¶å™¨ ï¼šæ§åˆ¶å™¨æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†è¯·æ±‚çš„Springç»„ä»¶ã€‚åœ¨å…¸å‹çš„åº”ç”¨ç¨‹åºä¸­å¯èƒ½ä¼šæœ‰å¤šä¸ªæ§åˆ¶å™¨ã€‚
- æ¨¡å‹ ï¼šæ§åˆ¶å™¨åœ¨å®Œæˆé€»è¾‘å¤„ç†åï¼Œé€šå¸¸ä¼šäº§ç”Ÿä¸€äº›ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯éœ€è¦è¿”å›ç»™ç”¨æˆ·å¹¶åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºã€‚è¿™äº›ä¿¡æ¯è¢«ç§°ä¸ºæ¨¡å‹ã€‚
- è§†å›¾ ï¼š ä¿¡æ¯éœ€è¦å‘é€ç»™è§†å›¾ï¼Œé€šå¸¸æ˜¯JSPæˆ–è€…Thymeleaf ç­‰ï¼ˆç°åœ¨éƒ½ç”¨HTMLäº†ï¼‰

## è·Ÿè¸ªSpring MVCè¯·æ±‚

![](http://zhangzhaolin.oss-cn-beijing.aliyuncs.com/18-8-21/34601160.jpg)

1. è¯·æ±‚æ—…ç¨‹çš„ç¬¬ä¸€ç«™æ˜¯`DispatcherServlet`ï¼ˆå‰ç«¯æ§åˆ¶å™¨ï¼‰ã€‚å‰ç«¯æ§åˆ¶å™¨æ˜¯å¸¸ç”¨çš„WEBåº”ç”¨ç¨‹åºæ¨¡å¼ï¼Œåœ¨è¿™é‡Œä¸€ä¸ªå•å®ä¾‹çš„Servletå°†è¯·æ±‚å§”æ‰˜ç»™åº”ç”¨ç¨‹åºçš„å…¶ä»–ç»„ä»¶æ¥æ‰§è¡Œå®é™…çš„å¤„ç†ã€‚`DispatherServlet`çš„ä»»åŠ¡æ˜¯å°†è¯·æ±‚å‘é€ç»™Spring MVCæ§åˆ¶å™¨ã€‚
2. `DispathcerServlet`é€šè¿‡æŸ¥è¯¢ä¸€ä¸ªæˆ–è€…å¤šä¸ª**å¤„ç†å™¨æ˜ å°„**ï¼ˆ`handler mapping`ï¼‰æ¥ç¡®å®šè¯·æ±‚çš„ä¸‹ä¸€ç«™åœ¨å“ªé‡Œ
3. `DispatcherServlet`ä¼šå°†è¯·æ±‚å‘é€ç»™é€‰ä¸­çš„æ§åˆ¶å™¨ã€‚åˆ°äº†æ§åˆ¶å™¨ï¼Œè¯·æ±‚ä¼šå¸ä¸‹å…¶**è´Ÿè½½**ï¼ˆç”¨æˆ·æäº¤ä¿¡æ¯ï¼‰å¹¶è€å¿ƒç­‰å¾…æ§åˆ¶å™¨å¤„ç†è¿™äº›ä¿¡æ¯ã€‚
4. æ§åˆ¶å™¨æ‰€åšçš„æœ€åä¸€ä»¶äº‹æƒ…å°±æ˜¯å°†æ¨¡å‹æ•°æ®æ‰“åŒ…ï¼Œå¹¶ä¸”æ ‡ç¤ºå‡ºç”¨äºæ¸²æŸ“è¾“å‡ºçš„è§†å›¾åã€‚æ¥ä¸‹æ¥ä¼šå°†**è¯·æ±‚**è¿åŒ**æ¨¡å‹**å’Œ**è§†å›¾å**å‘é€å›`DispatcherServlet`ã€‚
5. ä¼ é€’ç»™`DispatcherServlet`çš„è§†å›¾åä»…ä»…ä¼ é€’äº†ä¸€ä¸ª**é€»è¾‘åç§°**ï¼Œè¿™ä¸ªåå­—å°†ä¼šæŸ¥æ‰¾äº§ç”Ÿç»“æœçš„çœŸæ­£è§†å›¾ã€‚`DispatcherServlet`ä¼šä½¿ç”¨**è§†å›¾è§£æå™¨**ï¼ˆ`ViewResolver`ï¼‰æ¥å°†é€»è¾‘è§†å›¾ååŒ¹é…ä¸ºä¸€ä¸ªç‰¹å®šçš„è§†å›¾å®ç°ã€‚
6. è¯·æ±‚æœ€åä¸€ç«™æ˜¯è§†å›¾çš„å®ç°ï¼Œåœ¨è¿™é‡Œä»–äº¤ä»˜æ¨¡å‹æ•°æ®ã€‚

## æ­å»ºSpring MVC

æŒ‰ç…§ä¼ ç»Ÿçš„æ–¹å¼ï¼Œåƒ`DispathcerServlet`è¿™æ ·çš„Servletä¼šé…ç½®åœ¨`web.xml`æ–‡ä»¶ä¸­ã€‚ä½†å€ŸåŠ©äºServlet3å’ŒSpringçš„å¢å¼ºï¼Œè¿™ç§æ–¹å¼å·²ç»ä¸æ˜¯å”¯ä¸€çš„æ–¹å¼äº†ã€‚

æˆ‘ä»¬ä¼šä½¿ç”¨Javaå°†`DispathcerServlet`é…ç½®åœ¨Servletå®¹å™¨ä¸­ï¼Œè€Œä¸æ˜¯ç”¨web.xmlæ–‡ä»¶ã€‚

### é…ç½®`DispatcherServlet`

```java
public class SpittrWebAppInitializer extends AbstractAnnotationConfigDispatcherServletInitializer {

    protected Class<?>[] getRootConfigClasses() {
        return new Class[]{RootConfig.class};
    }

    // æŒ‡å®šé…ç½®ç±»
    protected Class<?>[] getServletConfigClasses() {
        return new Class[]{WebConfig.class};
    }

    // å°†DispatcherServletæ˜ å°„åˆ°"/"
    protected String[] getServletMappings() {
        return new String[]{"/"};
    }
}
```

### `AbstractAnnotationConfigDispatcherServletInitializer`å‰–æ

ğŸ”ºåœ¨Servlet3.0ç¯å¢ƒä¸­ ï¼Œå®¹å™¨ä¼šåœ¨ç±»è·¯å¾„ä¸­æŸ¥æ‰¾å®ç°`ServletContainerInitializer`æ¥å£çš„ç±»ï¼Œå¦‚æœèƒ½å‘ç°çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šç”¨å®ƒæ¥é…ç½®`Servlet`å®¹å™¨ã€‚

Springæä¾›äº†è¿™ä¸ªæ¥å£çš„å®ç° ï¼š

```java
@HandlesTypes(WebApplicationInitializer.class)
public class SpringServletContainerInitializer implements ServletContainerInitializer {
	// ...
}
```

`SpringServletContainerInitializer`è¿™ä¸ªç±»åè¿‡æ¥ä¼šæ‰¾å®ç°äº†`WebApplicationInitializer`çš„ç±»å¹¶å°†é…ç½®çš„ä»»åŠ¡äº¤ç»™å®ƒä»¬æ¥å®Œæˆã€‚Springæœ‰ä¸€ä¸ª`WebApplicationInitializer`åŸºç¡€å®ç°ï¼Œä¹Ÿå°±æ˜¯ `AbstractAnnotationConfigDispatcherServletInitializer`ã€‚

å› ä¸ºæˆ‘ä»¬çš„`SpittrWebAppInitializer`æ‰©å±•äº†`AbstractAnnotationConfigDispatcherServletInitializer`ï¼ˆåŒæ—¶ä¹Ÿå®ç°äº†`WebApplicationInitializer`ï¼‰ï¼Œå› æ­¤å½“éƒ¨ç½²åˆ°Servlet3.0æ—¶ï¼Œå®¹å™¨ä¼šè‡ªåŠ¨å‘ç°å®ƒï¼Œå¹¶ç”¨å®ƒæ¥é…ç½®åº”ç”¨ä¸Šä¸‹æ–‡ã€‚

![](https://raw.githubusercontent.com/zhangzhaolin/GraphBed/master/2019/09/20190923144029.png)

`SpittrWebAppInitializer`ç±»ä¸­çš„ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯`getServletMapping()`ï¼Œå®ƒä¼šå°†ä¸€ä¸ªæˆ–è€…å¤šä¸ªè·¯å¾„æ˜ å°„åˆ°`DispatcherServlet`ä¸Šã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå®ƒæ˜ å°„çš„æ˜¯"/"ï¼Œè¿™è¡¨æ˜å®ƒä¼šæ˜¯åº”ç”¨é»˜è®¤çš„Servletï¼Œå®ƒä¼šå¤„ç†è¿›å…¥åº”ç”¨çš„**æ‰€æœ‰è¯·æ±‚**ã€‚

### ä¸¤ä¸ªåº”ç”¨ä¸Šä¸‹æ–‡çš„æ•…äº‹

åœ¨Spring Webåº”ç”¨ä¸­ï¼Œé€šå¸¸æœ‰ä¸¤ä¸ªç±»æ¥åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡ ï¼š`DispatcherServlet`å’Œ`ContextLoaderListener`ã€‚

ğŸ”ºæˆ‘ä»¬å¸Œæœ›`DispatherServlet`åŠ è½½åŒ…å«WEBç»„ä»¶çš„beanï¼Œå¦‚æ§åˆ¶å™¨ã€è§†å›¾è§£æå™¨ä»¥åŠå¤„ç†å™¨æ˜ å°„ï¼›è€Œ`ContextLoaderListener`è¦åŠ è½½åº”ç”¨ä¸­çš„å…¶ä»–beanï¼Œä¾‹å¦‚æ•°æ®å±‚ç»„ä»¶ã€é©±åŠ¨åº”ç”¨åç«¯çš„ä¸­é—´å±‚ç­‰ã€‚

äº‹å®ä¸Šï¼Œ`AbstractAnnotationConfigDispatcherServletInitializer`ä¼šåŒæ—¶å®ç°`DispatcherServlet`ä»¥åŠ`ContextLoaderListener`ã€‚**`getServletConfigClass()`æ–¹æ³•è¿”å›çš„å¸¦æœ‰`@Configuration`çš„ç±»å°†ç”¨æ¥å®šä¹‰`DispatcherServlet`åº”ç”¨ä¸Šä¸‹æ–‡çš„bean**ã€‚**`getRootConfigClass()`æ–¹æ³•å¸¦æœ‰çš„`@Configuration`çš„ç±»å°†ä¼šç”¨æ¥é…ç½®`ContextLoaderListener`åˆ›å»ºçš„åº”ç”¨ä¸Šä¸‹æ–‡çš„bean**ã€‚

åœ¨æœ¬ä¾‹ä¸­ï¼Œ`ContextLoaderListener`å®šä¹‰åœ¨`RootConfig.class`ä¸­ï¼Œè€Œ`DispatcherServlet`å®šä¹‰åœ¨`WebConfig.class`ä¸­

> WebConfig.class

```java
@Configuration
@EnableWebMvc
@ComponentScan(basePackages = "spittr.web")
public class WebConfig implements WebMvcConfigurer {

    @Autowired
    private ApplicationContext applicationContext;
	// è§†å›¾è§£æå™¨
    @Bean
    public ViewResolver viewResolver() {
        ThymeleafViewResolver resolver = new ThymeleafViewResolver();
        resolver.setTemplateEngine(templateEngine());
        resolver.setCharacterEncoding("UTF-8");
        return resolver;
    }
	
    @Bean
    public ISpringTemplateEngine templateEngine() {
        SpringTemplateEngine engine = new SpringTemplateEngine();
        engine.setEnableSpringELCompiler(true);
        engine.setTemplateResolver(templateResolver());
        return engine;
    }

    private ITemplateResolver templateResolver() {
        SpringResourceTemplateResolver resolver = new SpringResourceTemplateResolver();
        resolver.setPrefix("/resources/templates/");
        resolver.setSuffix(".html");
        resolver.setApplicationContext(applicationContext);
        resolver.setCacheable(false);
        resolver.setTemplateMode(TemplateMode.HTML);
        return resolver;
    }

    @Override
    public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {
        configurer.enable();
    }

    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/resources/static")
                .addResourceLocations("/resources/static/**");
    }

}
```

é€šè¿‡è°ƒç”¨`DefaultServletHandlerConfigurer`çš„`enable()`æ–¹æ³•ï¼Œæˆ‘ä»¬è¦æ±‚`DispatcherServlet`å°†å¯¹é™æ€èµ„æºçš„è¯·æ±‚è½¬å‘åˆ°`Servlet`å®¹å™¨ä¸­é»˜è®¤çš„`Servlet`ä¸Šï¼Œè€Œä¸æ˜¯ç”¨`DispatcherServlet`æœ¬èº«å¤„ç†é™æ€èµ„æºã€‚

> RootConfig.class

```java

@Configuration
@Import({DataConfig.class})
@ComponentScan(basePackages = "spittr" ,
    excludeFilters = {
        @ComponentScan.Filter(type = FilterType.ANNOTATION , value = EnableWebMvc.class)
    }
)
public class RootConfig {

}
```

> DataConfig.class â€”â€” æ•°æ®æºé…ç½®

```java
@Configuration
@PropertySource("classpath:/application.properties")
public class DataConfig {

    private final Environment environment;

    @Autowired
    public DataConfig(Environment environment) {
        this.environment = environment;
    }

    @Bean
    public DataSource dataSource() throws SQLException {
        DruidDataSource dataSource = new DruidDataSource();
        dataSource.setDbType(environment.getProperty("datasource.dbtype"));
        dataSource.setUrl(environment.getProperty("datasource.url"));
        dataSource.setUsername(environment.getProperty("datasource.username"));
        dataSource.setPassword(environment.getProperty("datasource.password"));
        // é…ç½®WallFilter
        dataSource.setFilters("wall");
        // PSCache
        dataSource.setPoolPreparedStatements(false);
        return dataSource;
    }

    @Bean
    public JdbcOperations jdbcOperations(DataSource dataSource){
        return new JdbcTemplate(dataSource);
    }

}
```

## ç¼–å†™åŸºæœ¬çš„æ§åˆ¶å™¨

```java
@Controller
@RequestMapping(value = "/")
public class HomeController {
    @GetMapping
    public String home(){
        return "home";
    }
}
```

> home.html â€”â€” ä½¿ç”¨çš„æ—¶semantic ui

```html
<div class="ui text container">
    <div class="ui two column centered grid" style="padding-top: 5%;">
        <div class="center aligned column">
            <h1>æ¬¢è¿æ¥åˆ°Spittr</h1>
        </div>
        <div class="column row">
            <div class="center aligned column">
                <a th:href="@{/spittles}">Spittles</a>
                ||
                <a th:href="@{/spitter/register}">æ³¨å†Œ</a>
            </div>
        </div>
    </div>
</div
```

ä¹‹åè¿è¡Œç¨‹åºï¼Œæ•ˆæœå›¾å¦‚ä¸‹æ‰€ç¤º ï¼š

![é¦–é¡µ](http://zhangzhaolin.oss-cn-beijing.aliyuncs.com/18-8-23/3222114.jpg)

### ä¼ é€’æ¨¡å‹åˆ°è§†å›¾ä¸­

> SpittleRepository.java

```java
public interface SpittleRepository{
    /**
     * @param max Spittleä¸­IDçš„æœ€å¤§ä¸ªæ•°
     * @param count æœ€å¤šè¿”å›çš„Spittleä¸ªæ•°
     * @return 
     */
    List<Spittle> findSpittles(long max,int count);
}
```

> JdbcSpittleRepository.java

```java
public class JdbcSpittleRepository implements SpittleRepository{
    
    private final JdbcOperations jdbcOperations;
    
    @Autowired
    public JdbcOperations(JdbcOperations jdbcOperations){
        this.jdbcOperations = jdbcOperations;
    }
    
    public List<Spittle> findSpittles(long max,int count){
        return jdbcOperations.query("SELECT * FROM spittle WHERE ID < ? ORDER BY created_at DESC LIMIT ?",new SpittleRowMap(),max,count);
    }
    
    private class SpittleRowMap implements RowMapper<Spittle>{
        @Override
        public Spittle mapRow(ResultSet rs , int rowNum) throws SQLException {
            return new Spittle(
                    rs.getLong("id"),
                    rs.getString("message"),
                    rs.getTimestamp("created_at"),
                    rs.getDouble("latitude"),
                    rs.getDouble("longitude")
            );
        }
    }
}
```

> Spittle.java

```java
public class Spittle {
    private final Long id;
    private final String message;
    private final Timestamp time;
    private Double latitude;
    private Double longitude;
    public Spittle(String message , Timestamp time) {
        this(null,message,time,null,null);
    }
    public Spittle(Long id,String message , Timestamp time , Double latitude , Double longitude) {
        this.id = id;
        this.message = message;
        this.time = time;
        this.latitude = latitude;
        this.longitude = longitude;
    }
	// ...
}
```

> SpittleController.java

```java
@Controller
@RequestMapping(value = "/spittles")
public class SpittleController {

    private SpittleRepository spittleRepository;
    private static final String MAX_LONG_AS_STRING = "2147483647";

    @Autowired
    public SpittleController(SpittleRepository spittleRepository) {
        this.spittleRepository = spittleRepository;
    }

    @GetMapping
    public String spittles(
            @RequestParam(value = "max", defaultValue = MAX_LONG_AS_STRING) long max,
            @RequestParam(value = "count", defaultValue = "15") int count, Model model) {
        model.addAttribute("spittlesList", spittleRepository.findSpittles(max, count));
        return "spittles";
    }
}    
```

è¿˜å¯ä»¥æœ‰å¦ä¸€ç§æ›¿ä»£æ–¹å¼ç¼–å†™`spittles()`æ–¹æ³•ï¼š

```java
@GetMapping
public List<Spittle> spittles(
        @RequestParam(value = "max", defaultValue = MAX_LONG_AS_STRING) long max,
        @RequestParam(value = "count", defaultValue = "15") int count, Model model) {
    return spittleRepository.findSpittles(max, count);
}
```

é€»è¾‘è§†å›¾çš„åç§°ä¼šæ ¹æ®è¯·æ±‚è·¯å¾„æ¨æ–­ã€‚

> spittles.html

```html
<div class="ui text container">
    <div class="ui grid" style="padding-top: 5%">
        <div class="row">
            <ol class="ui list" id="spittlesList">
                <li class="item" th:value="${status.index + 1}" th:each="spittle,status : ${spittleList}">
                    <div class="content">
                        <a th:text="${spittle.message}">message</a>
                        <div class="description" th:text="${#dates.format(spittle.time,'yyyy-MM-dd HH:mm:ss')}"></div>
                    </div>
                </li>
            </ol>
        </div>
    </div>
</div>
```

## æ¥å—è¯·æ±‚çš„è¾“å…¥

Spring MVCä»¥å¤šç§æ–¹å¼å°†å®¢æˆ·ç«¯ä¸­çš„æ•°æ®ä¼ åˆ°æ§åˆ¶å™¨çš„å¤„ç†æ–¹æ³•ä¸­ï¼ŒåŒ…æ‹¬ï¼š

- æŸ¥è¯¢å‚æ•°
- è¡¨å•å‚æ•°
- è·¯å¾„å˜é‡

### å¤„ç†æŸ¥è¯¢å‚æ•°

```java
public JsonUtils spittlesPost(
            @RequestParam(value = "max" , defaultValue = MAX_LONG_AS_STRING) long max,
            @RequestParam(value = "count" , defaultValue = "10") int count){
        return new JsonUtils(ResultEnum.SUCCESS,null,
                spittleRepository.findSpittles(max,count));
}
```

### é€šè¿‡è·¯å¾„å‚æ•°æŸ¥è¯¢

```java
@PostMapping(value = "/show/{spittleId}")
@ResponseBody
public JsonUtils spittlePost(@PathVariable Long spittleId){
	return new JsonUtils(ResultEnum.SUCCESS,null,spittleRepository.findSpittle(spittleId));
}
```

å¦‚æœ`@PathVariable`ä¸­æ²¡æœ‰`value`å±æ€§çš„è¯ï¼Œå®ƒä¼šå‡è®¾å ä½ç¬¦çš„åç§°ä¸æ–¹æ³•çš„å‚æ•°åç›¸åŒã€‚

## å¤„ç†è¡¨å•

```java
@Controller
@RequestMapping(value = "/spitter")
public class SpitterController {

    private final SpitterRepository spitterRepository;

    @Autowired
    public SpitterController(SpitterRepository spitterRepository) {
        this.spitterRepository = spitterRepository;
    }

    @GetMapping(value = "/register")
    public String showRegisterForm(Model model) {
        model.addAttribute(new Spitter());
        return "register";
    }

    @PostMapping(value = "/register")
    public String processRegisteration(@Valid Spitter spitter, Errors error) {
        if (error.hasErrors()) {
            return "/register";
        }
        spitterRepository.save(spitter);
        return "redirect:/spitter/user/" + spitter.getUserName();
    }

    @GetMapping(value = "/user/{username}")
    public String showSpitterProfile(){
        return "profile";
    }

    @PostMapping(value = "/user/{username}")
    @ResponseBody
    public JsonUtils spitterProfile(@PathVariable String username){
        return new JsonUtils(ResultEnum.SUCCESS,null,
                spitterRepository.findOneByUserName(username));
    }
}
```

```java
public class Spitter {
	private Long id;
    private String firstName;
    private String lastName;
    private String userName;
    private String passWord;
    private String email;
    // ....
}
```

å½“`InternalResourceViewResolver`çœ‹åˆ°è§†å›¾ä¸­çš„`redirect:`å‰ç¼€çš„æ—¶å€™ï¼Œå®ƒå°±çŸ¥é“è¦å°†å…¶è§£æä¸ºé‡å®šå‘çš„è§„åˆ™ï¼Œè€Œä¸æ˜¯è§†å›¾çš„åç§°ã€‚é™¤äº†å¯ä»¥è¯†åˆ«`redirect:`å‰ç¼€ï¼Œ`InternalResourceResolver`è¿˜å¯ä»¥è¯†åˆ«`forward:`å‰ç¼€ï¼Œè¯·æ±‚å°†ä¼šå‰å¾€æŒ‡å®šçš„è·¯å¾„ã€‚

### æ ¡éªŒè¡¨å•

åœ¨æ ¡éªŒè¡¨å•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¼å…¥ä¸¤ä¸ªåŒ… ï¼š

```xml
<!-- https://mvnrepository.com/artifact/javax.validation/validation-api -->
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>2.0.1.Final</version>
        </dependency>
        <!-- https://mvnrepository.com/artifact/org.hibernate.validator/hibernate-validator -->
        <dependency>
            <groupId>org.hibernate.validator</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>6.0.12.Final</version>
        </dependency>
```

ä¹‹åï¼Œæˆ‘ä»¬åœ¨å®ä½“ç±»ä¸­åŠ å…¥å¦‚ä¸‹æ³¨è§£ ï¼š

```java
@NotNull
@Size(min = 2 , max = 30)
private String firstName;

@NotNull
@Size(min = 2 , max = 30)
private String lastName;

@NotNull
@Size(min = 5 , max = 16)
private String userName;

@NotNull
@Size(min = 5 , max = 25)
private String passWord;

private String email;
```

Controlleræ§åˆ¶å±‚ä¸­ ï¼š

```java
@PostMapping(value = "/register")
public String processRegisteration(@Valid Spitter spitter, Errors error) {
    if (error.hasErrors()) {
        return "/register";
    }
    spitterRepository.save(spitter);
    return "redirect:/spitter/user/" + spitter.getUserName();
}
```