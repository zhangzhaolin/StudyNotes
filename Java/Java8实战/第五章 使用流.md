# 使用流

## 筛选和切片

- 用谓词筛选
- 筛选出各不相同的元素
- 忽略流中的头几个元素

### 用谓词筛选

筛选出所有素菜 ：

```java
List<Dish> vegetarianMenu = menu.stream().filter(Dish::isVegetarian).collect(Collectors.toList());
```

### 筛选各异的元素

`distinct`方法会返回一个元素各异的流（根据流所生成元素的`hashCode`和`equals`方法实现）

```java
Stream.of(1, 2, 1, 3, 3, 2, 4).filter(i -> i % 2 == 0).distinct().forEach(System.out::println);
```

### 截断流

`limit(n)`方法会返回一个长度不超过n的流。如果流是有序的，则最多会返回前n个元素。

例如返回卡路里超过300的前三个菜 ：

```java
List<Dish> limitMenu = 
    menu.stream()
    	.filter(item -> item.getCalories() > 300)
        .limit(3)
    	.collect(Collectors.toList());
```

`limit`也可以用在无序流上，这种情况下，`limit`的结果不会以任何顺序排列。

### 跳过元素

流还支持`skip(n)`方法，返回一个扔掉了前n个元素的流。**如果流中元素不足n个，那么返回一个空流**。

例如：跳过卡路里高于300的前两道菜 

```java
List<Dish> skipMenu = 
    menu.stream()
    	.filter(d->d.getCalories() > 300)
    	.skip(3);
```

## 映射

一个常见的数据处理思路就是从某些对象中选择信息，例如在SQL中，可以选择一列。

### 对流中每一个元素应用函数

流支持`map`方法，它会接受<u>一个函数作为参数</u>。这个函数会被应用到每个元素上，并将其<u>映射</u>成一个新的元素。

`map()`方法的源代码如下 ：

```java
<R> Stream<R> map(Function<? super T, ? extends R> mapper);
```

例如 ： 提取菜肴名称 

```java
List<String> menuNames = 
    menu.stream()
    	.map(Dish::getName)
    	.collect(Collectors.toList());
```

或者提取菜肴名称的长度 ：

```java
List<Integer> menuNameLength = 
    menu.stream()
    	.map(d -> d.getName().length())
    	.collect(Collectors.toList());
```

### 流的扁平化

例如 ： 给定单词列表`["Hello","World"]`，列出其中各不相同的字符 

有一个`Arrays.stream()`的方法可以接受一个数组并产生一个流 ：

```java
String[] strs = {"Hello", "World"};
Stream<String> stream = Arrays.stream(strs);
stream.forEach(System.out::println);
/**
	打印如下 ：
	Hello
	World
*/
```

```java
Stream.of("Hello", "World")
        .map(s -> s.split(" "))
        .flatMap(Arrays::stream)
        .distinct()
        .collect(Collectors.toList());
```

例如 ： 给定列表`[1,2,3]`和列表`[3,4]`，返回所有的数对 ：

```java
List<Integer> number1 = Arrays.asList(1, 2, 3);
List<Integer> number2 = Arrays.asList(3, 4);

List<Integer[]> result =
        number1.stream()
                .flatMap(
                        a -> number2.stream().map(b -> new Integer[]{a, b})
                )
                .collect(Collectors.toList());
```

扩展 ：返回能被3整除的所有数对 

```java
List<Integer> number1 = Arrays.asList(1, 2, 3);
List<Integer> number2 = Arrays.asList(3, 4);
List<int[]> result =
        number1.stream()
                .flatMap(
                        a -> number2
                                .stream()
                                .filter(b -> (a + b) % 3 == 0)
                                .map(b -> new int[]{a, b})
                )
                .collect(Collectors.toList());
```

## 查找和匹配







